{{ define "main" }}
<main class="max-w-3xl w-full mb-4">
  <article class="bg-white mb-4 md:p-6 p-3 rounded-lg">
    <!-- Tag -->
    {{ if .Params.tags }}
    <div class="mb-8">
      {{ range .Params.tags }}
      <a class="border duration-500 hover:bg-primary hover:border-primary hover:text-white inline-block mr-2 my-1 px-3 py-1 rounded-full text-sm" href="/tags/{{ lower . }}">
        {{ . }}
      </a>
      {{ end }}
    </div>
    {{ end }}
    <!-- /Tag -->
    <!-- Title -->
    <h1 class="text-2xl text-secondary mb-8 font-medium">
      {{ .Title }}
    </h1>
    <!-- /Title -->
    <!-- Date -->
    <div class="float-right mb-8">
      <span class="mr-2">
        <i class="far fa-calendar-alt mr-1"></i>
        </i>{{ .PublishDate.Format "2006/01/02" }}
      </span>
      <span>
        <i class="fas fa-sync-alt mr-1"></i>
        {{ .Lastmod.Format "2006/01/02" }}
      </span>
    </div>
    <!-- /Date -->
    <!-- Thumbnail -->
    <img class="bg-gray-200 border mb-8 rounded-lg w-full" src="{{ if .Params.image }}{{ .Permalink }}/{{ .Params.image }}{{ else }}{{ .Site.BaseURL }}/img/default.png{{ end }}" alt="thumbnail" />
    <!-- /Thumbnail -->
    <!-- Social Button -->
    <div class="mb-8">
      {{ partial "social-btn.html" . }}
    </div>
    <!-- /Social Button -->
    <!-- Content -->
    <div class="content mb-8">
      {{ $content := .Content }}
      {{ range findRE "id=\".+?\"" .Content }}
      {{ $hash := . | replaceRE "id=\"" "" | replaceRE "\"" "" | md5 }}
      {{ $content = $content | replaceRE . (print "id=\"_" $hash "\"") }}
      {{ end }}
      {{ range findRE "href=\"#.+?\"" $content }}
      {{ $hash := . | replaceRE "href=\"" "" | replaceRE "\"" "" | replaceRE "#" "" | md5 }}
      {{ $content = $content | replaceRE . (print "href=\"#_" $hash "\"") }}
      {{ end }}
      {{ $content | safeHTML }}
    </div>
    <!-- /Content -->
    <!-- Social Button -->
    <div>
      {{ partial "social-btn.html" . }}
    </div>
    <!-- /Social Button -->
  </article>
  <!-- Google AdSense -->
  {{ if and .Site.Params.googleAdsClientID .Site.Params.googleAdsUnitID .Params.googleAds }}
  <aside class="flex mb-4">
    <ins class="adsbygoogle w-full" style="display:block" data-ad-client="{{ .Site.Params.googleAdsClientID }}" data-ad-slot="{{ .Site.Params.googleAdsUnitID }}" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    <ins class="adsbygoogle w-full" style="display:block" data-ad-client="{{ .Site.Params.googleAdsClientID }}" data-ad-slot="{{ .Site.Params.googleAdsUnitID }}" data-ad-format="auto" data-full-width-responsive="true"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </aside>
  {{ end }}
  <!-- /Google AdSense -->
</main>
<aside class="hidden max-w-xs w-full xl:inline-block mb-4">
  {{ partial "profile-card.html" . }}
  <div class="sticky top-4">
    {{ partial "search-form.html" . }}
    {{ partial "toc.html" . }}
    {{ partial "article-list.html" . }}
  </div>
</aside>
{{ end }}

{{ define "aside" }}
{{ partial "profile-card.html" . }}
{{ partial "search-form.html" . }}
{{ partial "toc.html" . }}
{{ partial "article-list.html" . }}
{{ end }}